<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:b="http://java.sun.com/jsf/html"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:a4j="http://richfaces.org/a4j">
	
<ui:composition template="/resources/common/commonLayout.xhtml">
		<ui:define name="content">
		<h:panelGroup id="addNewContactDiv" layout="block" styleClass="addNewContactDiv" rendered="#{contactController.renderDiv}">
			<h:form id="addContactForm" >
		        	<h:panelGrid rendered="#{contactController.canAddMoreContacts}" columns="2">
		        				
		        				<h:inputText id="email" value="#{contactController.emailAddress}" class="accountCredentials" p:placeholder="Email" required="true" requiredMessage="Email required ," validatorMessage="Email:Invalid ">
		        					<f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$"/>
		        				</h:inputText>
		        				

		        				<h:inputText value="#{contactController.address.streetAddress}" class="accountCredentials" p:placeholder="Street Address" />
		        			
		        		
		        				<h:inputText id="fname" value="#{contactController.firstName}" class="accountCredentials" p:placeholder="FirstName" required="true" requiredMessage="First Name required ," validatorMessage="First Name:Only Alphabets">
									<f:validateRegex pattern="^[a-zA-Z\s]*$" />
		        				</h:inputText>
		        					
		        				
		        				<h:inputText id="city" value="#{contactController.address.city}" class="accountCredentials" p:placeholder="City" required="true" requiredMessage="City Required ," validatorMessage="City:Only Alphabets">
		        					<f:validateRegex pattern="^[a-zA-Z\s]*$"/>
		        				</h:inputText>
		        				
		        				
		        				
		        				<h:inputText id="lname" value="#{contactController.lastName}" class="accountCredentials" p:placeholder="Last Name" required="true" requiredMessage="Last Name required ," validatorMessage="Last Name:Only Alphabets">
		        					<f:validateRegex pattern="^[a-zA-Z\s]*$"/>
		        				</h:inputText>
		        				
		        				<h:inputText id="country" value="#{contactController.address.country}" class="accountCredentials" p:placeholder="Country" required="true" requiredMessage="country required ," validatorMessage="Country:Only Alphabets">
		        					<f:validateRegex pattern="^[a-zA-Z\s]*$"/>
		        				</h:inputText>
		        				
		        				<h:inputText id="phnumber" value="#{contactController.phoneNumber}" class="accountCredentials" p:placeholder="Mobile Number">
		        				</h:inputText>
								<h:selectOneRadio value="#{contactController.gender}">
									<f:selectItem itemValue="Male" itemLabel="Male"/>
									<f:selectItem itemValue="Female" itemLabel="Female"/>
								</h:selectOneRadio>
			        			<h:selectBooleanCheckbox value="#{contactController.hasLogin}" rendered="#{contactController.canAddMoreLogins}"/>Has Login
		        	</h:panelGrid>
		        	<h:message for="country" styleClass="warningError"/>
		        	<br/>
		        	<h:message for="lname" styleClass="warningError"/>
		    		<br/>
		    		<h:message for="email" styleClass="warningError"/>
		        	<br/>
		        	<h:message for="fname" styleClass="warningError"/>
		        	<br/>
		        	<h:message for="city" styleClass="warningError"/>
		        	<h:outputLabel value="#{contactController.errorMessage}" styleClass="warningError" rendered="#{contactController.renderError}" />
		        			<h:commandButton actionListener="#{contactController.addNewContact()}" value="Save" id="saveNewAccountButton" class="newAccountBottomButton" rendered="#{contactController.canAddMoreContacts}" style="left:35%;">
		        				<a4j:ajax execute="addContactForm"  render="contactForm:contactTable"/>
		        			</h:commandButton>
				        	<h:commandButton action="#{contactController.closeNewContactDiv()}" value="Cancel" immediate="true" id="cancelAddingNewContactButton" class="newAccountBottomButton" style="left:50%;">
				        		<a4j:ajax execute="cancelAddingNewContactButton" render="addNewContactDiv"/>
				        	</h:commandButton>
        	</h:form>
        </h:panelGroup>
        <div class="toolBox">
			<input type="text" id="search" onkeyup="filter('search','contactForm:contactTable')" class="searchBar" placeholder="Search for names.." />
			
			<!--  <h:graphicImage class="addNewAccountImage" value="#{resource['images:addNewUserImage.png']}"/>-->
			<h:form>
				<h:commandButton id="addNewContactButton" action="#{contactController.openNewContactDiv()}" styleClass="addNewAccountButton" value="New User">
					<a4j:ajax execute="addNewContactButton" render="addNewContactDiv"/>
				</h:commandButton>
				<h:commandLink action="#{mapController.showContactHomesOnMap(contactController.account.id)}" styleClass="viewContactHomesOnMapLink" value="View Contact Homes On Map" />
				<h:commandLink action="#{alertProfileController.openAccountAlertProfiles(contactController.account.id)}" styleClass="addNewAccountButton" value="Alert Profile" />
				<h:commandLink action="/resources/secured/contract/contract" styleClass="addNewAccountButton" value="Contract" />
			</h:form>
			
        </div>
	<br/>
	<h:panelGroup layout="block" class="dataTable">
		<h:form id="contactForm">
	        <h:dataTable id="contactTable" class="table table-striped table-bordered table-hover table-condensed" value="#{contactController.contactsList}" var="contactItem">
	            <h:column>
	            	<f:facet name="header">First Name</f:facet>
	               <h:outputText value="#{contactItem.firstName}" rendered="#{!contactItem.editable}"/>
	               <h:inputText value="#{contactItem.firstName}" rendered="#{contactItem.editable}"/>
	            </h:column>
	            
	            <h:column>
	            	<f:facet name="header">Last Name</f:facet>
	               <h:outputText value="#{contactItem.lastName}" rendered="#{!contactItem.editable}"/>
	               <h:inputText value="#{contactItem.lastName}" rendered="#{contactItem.editable}"/>
	            </h:column>
	            
	            <h:column>
	            	<f:facet name="header">Gender</f:facet>
	               <h:outputText value="#{contactItem.gender}" rendered="#{!contactItem.editable}"/>
	               <h:inputText value="#{contactItem.gender}" rendered="#{contactItem.editable}"/>
	            </h:column>      
	            <h:column>
	            	<f:facet name="header">Phone Number</f:facet>
	               <h:outputText value="#{contactItem.phoneNumber}" rendered="#{!contactItem.editable}"/>
	               <h:inputText value="#{contactItem.phoneNumber}" rendered="#{contactItem.editable}"/>
	            </h:column>
	            
	            <h:column>
	            	<f:facet name="header">Email Address</f:facet>
	               <h:outputText value="#{contactItem.emailAddress}" rendered="#{!contactItem.editable}"/>
	               <h:inputText value="#{contactItem.emailAddress}" rendered="#{contactItem.editable}"/>
	            </h:column>
	            <h:column>
	            	<f:facet name="header">Actions</f:facet>
	            	<h:commandLink action="#{contactController.makeContactEditable(contactItem)}" value="Edit  " rendered="#{!contactItem.editable}">
	            		<f:ajax render="contactForm:contactTable" />
	            	</h:commandLink>
	            	<h:commandLink action="#{contactController.saveEdit(contactItem)}" value="Save  " rendered="#{contactItem.editable}">
	            		<f:ajax execute="contactForm" render="contactForm:contactTable" />
	            	</h:commandLink>
	            	<h:commandLink action="#{contactController.deleteContact(contactItem)}" value="Delete  " rendered="#{!contactItem.editable}">
	            		<f:ajax render="contactForm:contactTable" />
	            	</h:commandLink>
	            	<h:commandLink action="#{contactController.cancelEdit(contactItem)}" value="Cancel  " rendered="#{contactItem.editable}">
	            		<f:ajax render="contactForm:contactTable" />
	            	</h:commandLink>
	            </h:column>     
	        </h:dataTable>
		</h:form>
		
	</h:panelGroup>
			
		</ui:define>
	</ui:composition>
</html>